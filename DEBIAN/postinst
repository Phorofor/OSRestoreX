#!/bin/bash

echo "THIS PACKAGE WILL ASSIST IN ERASING YOUR DEVICE, YOU AGREE TO USE THIS AT YOUR OWN RISK. THANKS FOR THE METHOD /u/changemylife99."
<<<<<<< HEAD
echo "Thanks to contributions from ipadkid358 and thebeastgamer25"
=======
echo "Thanks to contributions from ipad_kid and thebeastgamer25"
>>>>>>> pr/6
tput bold
echo "If you would like to quit, exit Cydia NOW! I have purpousefully added a 10 second hang time for you to exit if needed. Use this time wisley."
tput sgr0
sleep 10

test "dpkg --get-selections | grep -v deinstall | grep com.officialscheduler.mterminal" = "" && {
echo "Updating your repos. This is needed to install MTerminal"
test "cat /etc/apt/sources.list.d/* | grep http://apt.thebigboss.org/repofiles/cydia/" = "" && { 
echo deb http://apt.thebigboss.org/repofiles/cydia/ stable main >> cydia.list
apt-get update
<<<<<<< HEAD

=======
>>>>>>> pr/6
echo "Installing MTerminal."
apt-get install com.officialscheduler.mterminal
echo "Done! Moving on to the actual erase!"
   }
}

echo "THIS IS YOUR LAST CHANCE TO CLOSE CYDIA WITHOUT ERASING DONE. YOU HAVE 5 SECONDS."
sleep 5

<<<<<<< HEAD
echo "Starting erase..."
rm /.installed_yaluX
echo "Removed Yalu file."
=======
echo "Starting erase…"
rm -f /.installed_yaluX
echo "Removed Yalu file marker file, this will allow Cydia to re-install when you re-jailbreak"
>>>>>>> pr/6

cd /var/mobile/

echo "Removing /var/mobile and it's contents…"
rm -R Backups
rm -R Containers
rm -R Documents
rm -R Downloads
rm -R Media
rm -R MobileSoftwareUpdate
echo "Removed all contents except for Library from /var/mobile."

<<<<<<< HEAD
echo "Removing the contents of /var/mobile/Library except for carrier settings and important files..."
echo "This step could take the longest."
=======
echo "Removing the contents of /var/mobile/Library except for carrier settings and important files…"
>>>>>>> pr/6

cd /var/mobile/Library

echo "Moved to /var/mobile/Library. Final erase starting."

filecontent=(`ls | grep -v Carrier | grep -v Operator | grep -v Preferences`)
for t in "${filecontent[@]}"
do
rm -r "$t"
done

<<<<<<< HEAD
echo "Removing stashed tweaks..."
cd /var/db/
rm -R stash

echo "Done removing stashed tweaks. Removing Cydia Substrate..."
echo "This should have dpkg remove all leftover tweak files and such."
apt-get --yes remove mobilesubstrate
echo "Removed mobilesubstrate. DO NOT RESPRING, I REPEAT, DO NOT RESPRING. YOU HAVE BEEN WARNED."
sleep 5

echo "Removing any other temporary files caused by Cydia and other tweaks."
rm /tmp/cydia.log
rm /tmp/flush.log
rm -R /Library/Themes
echo "Just removed Cydia log. More could be added soon over time, but this shouldnt matter to much."

tput bold
echo "PLEASE GO TO SETTINGS IMMEDIATLEY AND USE ERASE ALL CONTENTS AND SETTINGS! THIS TWEAK ONLY DOES HALF OF THE WORK NEEDED. PLEASE DO THIS!"
=======
echo "Removing stashed tweaks…"
rm -r /var/db/stash

echo "Done removing stashed tweaks. Removing Cydia Substrate…"
echo "This should have dpkg remove all leftover tweak files and such."

apt-get --yes remove mobilesubstrate
echo "Removed mobilesubstrate. DO NOT RESPRING, I REPEAT, DO NOT RESPRING. YOU HAVE BEEN WARNED."
sleep 5

echo "Removing any other temporary files caused by Cydia and other tweaks."
rm /tmp/cydia.log
rm /tmp/flush.log
rm -r /Library/Themes
echo "Just removed Cydia log. More could be added soon over time, but this shouldnt matter to much."

tput bold
echo PLEASE GO TO SETTINGS IMMEDIATLEY AND USE ERASE ALL CONTENTS AND SETTINGS! THIS TWEAK ONLY DOES HALF OF THE WORK NEEDED. PLEASE DO THIS!
>>>>>>> pr/6
tput sgr0
